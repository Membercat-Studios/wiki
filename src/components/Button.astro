---
// @ts-nocheck
import { Icon } from 'astro-icon/components';

interface Props {
  variant?: 'primary' | 'secondary' | 'success' | 'fail' | 'glass' | 'ghost' | 'custom' | 'modrinth';
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  rounded?: 'none' | 'sm' | 'md' | 'lg' | 'xl' | 'pill';
  fullWidth?: boolean;
  disabled?: boolean;
  icon?: string;
  iconPosition?: 'left' | 'right';
  href?: string;
  type?: 'button' | 'submit' | 'reset';
  class?: string;
}

const {
  variant = 'primary',
  size = 'md',
  rounded = 'md',
  fullWidth = false,
  disabled = false,
  icon,
  iconPosition = 'left',
  href,
  type = 'button',
  class: className = '',
} = Astro.props;

const isModrinth = variant === 'modrinth';
const modrinthDefaultIcon = 'simple-icons:modrinth';
const appliedIcon = isModrinth ? modrinthDefaultIcon : icon;
const isIconifyIcon = appliedIcon && appliedIcon.includes(':');

const variantClass = {
  primary: 'bg-[#db9c3e] hover:bg-[#c58a35] text-white',
  secondary: 'bg-zinc-900 hover:bg-zinc-800 text-white border border-zinc-800',
  success: 'bg-green-500 hover:bg-green-600 text-white',
  fail: 'bg-red-500 hover:bg-red-600 text-white',
  glass: 'bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white border border-white/10',
  ghost: 'bg-transparent hover:bg-zinc-900 text-white',
  custom: '',
  modrinth: 'bg-[#1bd96a] hover:bg-green-500 text-white'
};

const sizeClass = {
  xs: 'px-3 py-1.5 text-xs',
  sm: 'px-4 py-2 text-sm',
  md: 'px-5 py-2.5 text-base',
  lg: 'px-6 py-3 text-lg',
  xl: 'px-7 py-3.5 text-xl',
};

const roundedClass = {
  none: 'rounded-none',
  sm: 'rounded-sm',
  md: 'rounded-md',
  lg: 'rounded-lg',
  xl: 'rounded-xl',
  pill: 'rounded-full',
};

const baseClass = `
  inline-flex items-center justify-center gap-2 transition-colors duration-200
  focus:outline-none focus-visible:ring-2 focus-visible:ring-[#db9c3e] focus-visible:ring-offset-2 focus-visible:ring-offset-black
  font-medium select-none
  ${variantClass[variant]}
  ${sizeClass[size]}
  ${roundedClass[rounded]}
  ${fullWidth ? 'w-full' : ''}
  ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
  ${className}
`.trim().replace(/\s+/g, ' ');

const Tag = href ? 'a' : 'button';
---

<Tag
  href={href}
  type={href ? undefined : type}
  disabled={disabled}
  class={baseClass}
  target={href && href.startsWith('http') ? '_blank' : undefined}
  rel={href && href.startsWith('http') ? 'noopener noreferrer' : undefined}
>
  {appliedIcon && iconPosition === 'left' && (
    isIconifyIcon ? (
      <Icon name={appliedIcon} aria-hidden="true" />
    ) : (
      <i class={appliedIcon} aria-hidden="true"></i>
    )
  )}
  
  <slot />
  
  {appliedIcon && iconPosition === 'right' && (
    isIconifyIcon ? (
      <Icon name={appliedIcon} aria-hidden="true" />
    ) : (
      <i class={appliedIcon} aria-hidden="true"></i>
    )
  )}
</Tag>
